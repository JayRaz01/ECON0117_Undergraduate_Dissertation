(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     12597,        304]
NotebookOptionsPosition[     11485,        278]
NotebookOutlinePosition[     11921,        295]
CellTagsIndexPosition[     11878,        292]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{"u", ",", "p", ",", "f"}], "]"}]], "Input",
 CellChangeTimes->{{3.922523672877452*^9, 3.922523679046246*^9}, {
  3.922529335765562*^9, 3.9225293360352936`*^9}, {3.9225298010979214`*^9, 
  3.9225298015938463`*^9}},
 CellLabel->"In[63]:=",ExpressionUUID->"5bbbbe3a-1d66-41a2-95f6-0d701a7ccc1d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"eq1", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"A", " ", 
       SuperscriptBox["p", 
        RowBox[{"-", "1"}]]}], "==", " ", 
      FractionBox[
       RowBox[{"p", "-", "\[Alpha]"}], "\[Beta]"]}], "}"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"industry", " ", "equilibrium", " ", "condition"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"p", "[", "t_", "]"}], "=", 
  RowBox[{"p", "/.", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{"eq1", ",", " ", "p"}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}], " ", 
   RowBox[{"(*", 
    RowBox[{"solve", " ", "for", " ", "equilibrium", " ", "price"}], 
    "*)"}]}]}]}], "Input",
 CellChangeTimes->{{3.9225222462766113`*^9, 3.9225223870629373`*^9}, {
   3.9225224575999737`*^9, 3.922522458478728*^9}, {3.92252918044176*^9, 
   3.922529218321269*^9}, {3.9225292535865345`*^9, 3.922529263872863*^9}, 
   3.922529368589733*^9, {3.9225498793860197`*^9, 3.922549879460083*^9}, 
   3.9226279267483416`*^9, 3.9227464527407465`*^9, {3.9227465796506634`*^9, 
   3.9227466071582713`*^9}, {3.9227466440254116`*^9, 
   3.9227466939882903`*^9}},ExpressionUUID->"239ea14b-5936-4688-8d3f-\
c95db3f719da"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{"\[Alpha]", "+", 
    SqrtBox[
     RowBox[{
      SuperscriptBox["\[Alpha]", "2"], "+", 
      RowBox[{"4", " ", "A", " ", "\[Beta]"}]}]]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.9226279713676357`*^9, 3.922627976956932*^9}, {
  3.9226338089440727`*^9, 3.922633813940361*^9}, {3.922634270830474*^9, 
  3.9226343073563213`*^9}},
 CellLabel->"Out[66]=",ExpressionUUID->"d8b1cb1d-12ee-47ba-9b99-67ef4177c95d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"\[Alpha]", "+", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["\[Alpha]", "2"], "+", 
          RowBox[{"4", " ", "A", " ", "\[Beta]"}]}]]}], ")"}]}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "10"}], "}"}], ",", 
     RowBox[{
     "PlotLabel", "->", 
      "\"\<Equilibrium Price, \!\(\*SubscriptBox[\(p\), \(E\)]\)(t)\>\""}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"Frame", "->", "True"}], ",", 
     RowBox[{"FrameLabel", "->", 
      RowBox[{"{", 
       RowBox[{"\"\<time\>\"", ",", " ", "\"\< equilibrium price\>\""}], 
       "}"}]}]}], "]"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"A", ",", "0", ",", "10"}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"\[Alpha]", ",", "0", ",", "10"}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"\[Beta]", ",", "0", ",", "10"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.922524061605567*^9, 3.922524136698513*^9}, {
   3.9225241960094156`*^9, 3.922524197142888*^9}, {3.9225242662306805`*^9, 
   3.9225243097195034`*^9}, {3.922535221215086*^9, 3.922535246476766*^9}, 
   3.9225401875508056`*^9, {3.92254068684381*^9, 3.9225407220625353`*^9}, {
   3.922540760727719*^9, 3.922540764879282*^9}, {3.92254083960141*^9, 
   3.9225408726272535`*^9}, 3.922541317467025*^9, {3.9225413711741176`*^9, 
   3.9225413804190516`*^9}, 3.9225414346120615`*^9, {3.922549891880743*^9, 
   3.9225498979944897`*^9}, {3.922627936273017*^9, 3.922627939792036*^9}, {
   3.9226373246132984`*^9, 3.922637403104661*^9}, {3.922637530759718*^9, 
   3.9226375718985243`*^9}, {3.922637741224844*^9, 3.9226377446783075`*^9}, {
   3.9226377966634226`*^9, 3.9226378322034235`*^9}, {3.922746472918063*^9, 
   3.9227464778157663`*^9}, 3.9227465447582183`*^9, 
   3.92274670090823*^9},ExpressionUUID->"77ccb2cf-4878-42d7-b70f-\
17e4687ab95b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"HJB", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"u", "[", "t", "]"}], ",", "t"}], "]"}], "-", 
       RowBox[{"r", " ", 
        RowBox[{"u", "[", "t", "]"}]}], "+", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"2", " ", "\[Beta]"}]], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"p", "[", "t", "]"}], "-", "\[Alpha]"}], ")"}], "2"]}]}], 
      " ", "==", " ", "0"}], "}"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"Corresponding", " ", "HJB", " ", "equation"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DSolve", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"HJB", ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"u", "'"}], "[", "0", "]"}], "==", "0"}]}], "}"}], ",", " ", 
      RowBox[{"u", "[", "t", "]"}], ",", " ", "t", ",", " ", 
      RowBox[{"Assumptions", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"p", "[", "t", "]"}], "-", "\[Alpha]"}], ">", "0"}], 
        "}"}]}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Solve", " ", "HJB", " ", "for", " ", "value", " ", "function"}], 
    ",", " ", 
    RowBox[{
    "with", " ", "an", " ", "appropriate", " ", "boundary", " ", 
     "condition"}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.9225206817248783`*^9, 3.9225206871410265`*^9}, {
   3.922520720920517*^9, 3.9225207343400335`*^9}, {3.9225229476720643`*^9, 
   3.922523083974042*^9}, 3.922746488599521*^9, {3.9227467090517187`*^9, 
   3.922746747081356*^9}},ExpressionUUID->"94e0509b-8fbe-4df3-a44e-\
c8208998eaaf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"u", "[", "t", "]"}], "\[Rule]", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[Alpha]", "2"], "+", 
    RowBox[{"2", " ", "A", " ", "\[Beta]"}], "-", 
    RowBox[{"\[Alpha]", " ", 
     SqrtBox[
      RowBox[{
       SuperscriptBox["\[Alpha]", "2"], "+", 
       RowBox[{"4", " ", "A", " ", "\[Beta]"}]}]]}]}], 
   RowBox[{"4", " ", "r", " ", "\[Beta]"}]]}]], "Output",
 CellChangeTimes->{
  3.922523109655582*^9, 3.922523164396562*^9, {3.9225236861753645`*^9, 
   3.9225237396022167`*^9}, 3.922523810579631*^9, 3.922529390644661*^9, {
   3.922529600522783*^9, 3.922529652258684*^9}, {3.922529724467655*^9, 
   3.9225297568284283`*^9}, {3.9225298114888387`*^9, 
   3.9225299437388387`*^9}, {3.9225357389454136`*^9, 3.9225357656613417`*^9}, 
   3.922537164870674*^9, 3.922537375965841*^9, 3.9225387519882736`*^9, {
   3.9225416341858397`*^9, 3.922541638475521*^9}, 3.9225417069277687`*^9, 
   3.922545584515066*^9, {3.9225475927315617`*^9, 3.92254760230678*^9}, 
   3.922547719522877*^9, 3.9225478454124184`*^9, 3.922548567399043*^9, 
   3.9225488364464455`*^9, 3.9225489180539827`*^9, 3.922549673860633*^9, 
   3.922549819513136*^9, 3.922549937882723*^9, 3.9225538491884923`*^9, 
   3.922553882705757*^9, 3.9226006055666523`*^9, 3.9226080373072367`*^9, {
   3.922628002253642*^9, 3.9226280125920153`*^9}, 3.9226281377609377`*^9, 
   3.9226343158786354`*^9},
 CellLabel->"Out[69]=",ExpressionUUID->"4cadf2c8-954d-49a2-9b7c-13c9055d8bb3"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Alpha]", "2"], "+", 
       RowBox[{"2", " ", "A", " ", "\[Beta]"}], "-", 
       RowBox[{"\[Alpha]", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["\[Alpha]", "2"], "+", 
          RowBox[{"4", " ", "A", " ", "\[Beta]"}]}]]}]}], 
      RowBox[{"4", " ", "r", " ", "\[Beta]"}]], ",", " ", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "10"}], "}"}], ",", " ", 
     RowBox[{
     "PlotLabel", "->", 
      "\"\<Lifetime Profit, u(t,\!\(\*SubscriptBox[\(S\), \(0\)]\))\>\""}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"Frame", "->", "True"}], ",", 
     RowBox[{"FrameLabel", "->", 
      RowBox[{"{", 
       RowBox[{"\"\<time\>\"", ",", " ", "\"\<lifetime profit\>\""}], 
       "}"}]}]}], "]"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"A", ",", "0.01", ",", "10"}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"\[Alpha]", ",", "0.01", ",", "10"}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"\[Beta]", ",", "0.01", ",", "10"}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"r", ",", "0.01", ",", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.922523482765794*^9, 3.9225234844137077`*^9}, {
   3.922523515411311*^9, 3.9225236252105427`*^9}, {3.922523792703789*^9, 
   3.9225238544622917`*^9}, {3.9225239181364384`*^9, 3.922523939577339*^9}, {
   3.9225294524577117`*^9, 3.922529477437649*^9}, 3.9225295810765944`*^9, {
   3.92252977767632*^9, 3.922529777724862*^9}, 3.9225299598356533`*^9, {
   3.9225300238260717`*^9, 3.922530034470707*^9}, {3.9225358301066504`*^9, 
   3.9225358337542806`*^9}, {3.9225358757633333`*^9, 
   3.9225358762262306`*^9}, {3.922536011964725*^9, 3.9225360258521433`*^9}, {
   3.9225377224061637`*^9, 3.9225377660436144`*^9}, {3.922540650255409*^9, 
   3.922540651010557*^9}, 3.9225416267414513`*^9, {3.9225417199009027`*^9, 
   3.9225417206455417`*^9}, {3.922541801675583*^9, 3.9225418640436087`*^9}, {
   3.922541920150261*^9, 3.922541928055045*^9}, {3.922541991172714*^9, 
   3.922542008435029*^9}, {3.9225424413570576`*^9, 3.9225424554746737`*^9}, {
   3.9225467537885623`*^9, 3.922546778978681*^9}, {3.922547876390004*^9, 
   3.9225478994808207`*^9}, {3.9225481922856126`*^9, 
   3.9225482887589083`*^9}, {3.922548322859174*^9, 3.9225483251471376`*^9}, {
   3.9225484784051666`*^9, 3.922548491449362*^9}, {3.922548864096676*^9, 
   3.9225488933117485`*^9}, 3.922548929871626*^9, {3.9225489751469817`*^9, 
   3.9225489789672604`*^9}, {3.922549687581909*^9, 3.922549697944302*^9}, {
   3.922549749698719*^9, 3.922549766290959*^9}, {3.922549971907424*^9, 
   3.922550007999899*^9}, {3.9225503246126227`*^9, 3.9225503572981744`*^9}, {
   3.9225506034839563`*^9, 3.9225506086513915`*^9}, {3.9225515910064707`*^9, 
   3.9225515965412207`*^9}, {3.9225526190042205`*^9, 
   3.9225526458932977`*^9}, {3.9225526985715075`*^9, 
   3.9225527720830965`*^9}, {3.9225528247793217`*^9, 3.9225529189631524`*^9}, 
   3.9225533062310143`*^9, 3.9225533872880793`*^9, {3.922553663690794*^9, 
   3.92255367754068*^9}, {3.922553728197655*^9, 3.9225537543536024`*^9}, {
   3.92255385692263*^9, 3.9225538897763257`*^9}, 3.922608045617369*^9, {
   3.9226279485555573`*^9, 3.922627957300563*^9}, 3.92262814580434*^9, {
   3.9226417661611333`*^9, 3.9226419029029884`*^9}, 
   3.9227465504766254`*^9},ExpressionUUID->"81fa4b6e-71ec-4d96-b34f-\
c236b6c83e8b"],

Cell[BoxData[""], "Input",ExpressionUUID->"34873b9c-1b9d-44e5-8279-d405971b5904"]
},
WindowSize->{1440, 747.75},
WindowMargins->{{-6, Automatic}, {Automatic, -6}},
Magnification:>1. Inherited,
FrontEndVersion->"13.3 for Microsoft Windows (64-bit) (July 24, 2023)",
StyleDefinitions->"ReverseColor.nb",
ExpressionUUID->"d33bec07-ee15-46a0-a906-da881c013099"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 340, 6, 28, "Input",ExpressionUUID->"5bbbbe3a-1d66-41a2-95f6-0d701a7ccc1d"],
Cell[CellGroupData[{
Cell[923, 30, 1205, 30, 65, "Input",ExpressionUUID->"239ea14b-5936-4688-8d3f-c95db3f719da"],
Cell[2131, 62, 492, 12, 47, "Output",ExpressionUUID->"d8b1cb1d-12ee-47ba-9b99-67ef4177c95d"]
}, Open  ]],
Cell[2638, 77, 1987, 43, 73, "Input",ExpressionUUID->"77ccb2cf-4878-42d7-b70f-17e4687ab95b"],
Cell[CellGroupData[{
Cell[4650, 124, 1791, 52, 86, "Input",ExpressionUUID->"94e0509b-8fbe-4df3-a44e-c8208998eaaf"],
Cell[6444, 178, 1474, 28, 55, "Output",ExpressionUUID->"4cadf2c8-954d-49a2-9b7c-13c9055d8bb3"]
}, Open  ]],
Cell[7933, 209, 3464, 65, 83, "Input",ExpressionUUID->"81fa4b6e-71ec-4d96-b34f-c236b6c83e8b"],
Cell[11400, 276, 81, 0, 28, "Input",ExpressionUUID->"34873b9c-1b9d-44e5-8279-d405971b5904"]
}
]
*)

